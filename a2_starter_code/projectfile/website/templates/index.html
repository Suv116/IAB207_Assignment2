{% extends "layout.html" %}

{% block content %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show mt-3" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- Main content -->
<div class="container mt-5">

    <!-- The slideshow/carousel -->

    <div id="demo" class="carousel slide" data-bs-ride="carousel">

        <div class="carousel-indicators">
            <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="2"></button>
        </div>

        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/static/Concert5.jpg" alt="Los Angeles" class="d-block w-100 carousel-img">
            </div>
            <div class="carousel-item">
                <img src="/static/Concert3.jpg" alt="Chicago" class="d-block w-100 carousel-img">
            </div>
            <div class="carousel-item">
                <img src="/static/Concert4.jpg" alt="New York" class="d-block w-100 carousel-img">
            </div>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>

    <div class="container-fluid mt-3">
        <h3>Trending Now</h3>
        <a href="{{ url_for('main.events') }}"
           class="btn btn-sm btn-link p-0"
           style="font-size: 1rem; color: #2D2D2A; font-family: 'Oswald', sans-serif; transition: color 0.2s;"
           onmouseover="this.style.color='#ffffff'"
           onmouseout="this.style.color='#2D2D2A'">
            See More
        </a>

        <div class="row">
            {% for event in trending_events %}
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 mb-3">
                <div class="card h-100 event-card">
                    <img class="card-img-top event-img"
                         src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                         alt="Event image">
                    <div class="card-body p-2 d-flex flex-column">
                        <h6 class="card-title mb-1">{{ event.title }}</h6>
                        <p class="card-text small mb-2">
                            {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }} · Status: {{
                            event.status.value }}
                        </p>
                        <a href="{{ url_for('main.details', event_id=event.id) }}"
                           class="btn btn-primary btn-sm mt-auto w-100">
                            See Details
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>


        <hr class="section-divider">

        <div class="container-fluid mt-3 upcoming-section">
            <h3>Upcoming</h3>
            <p class="mb-1">View several upcoming concerts in your area!</p>
            <a href="{{ url_for('main.events') }}"
               class="btn btn-sm btn-link p-0"
               style="font-size: 1rem; color: #2D2D2A; font-family: 'Oswald', sans-serif; transition: color 0.2s;"
               onmouseover="this.style.color='#ffffff'"
               onmouseout="this.style.color='#2D2D2A'">
                See More
            </a>

            <div class="row">
                {% for event in trending_events %}
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 mb-3">
                    <div class="card h-100 event-card">
                        <img class="card-img-top event-img"
                             src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                             alt="Event image">
                        <div class="card-body p-2 d-flex flex-column">
                            <h6 class="card-title mb-1">{{ event.title }}</h6>
                            <p class="card-text small mb-2">
                                {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }} · Status: {{
                                event.status.value }}
                            </p>
                            <p class="card-text small text-muted mb-2">
                                Tickets left:
                                {{ event.attendees - (event.orders | map(attribute='quantity') | sum) if event.orders else event.attendees }}
                            </p>
                            <a href="{{ url_for('main.details', event_id=event.id) }}"
                               class="btn btn-primary btn-sm mt-auto w-100">
                                See Details
                            </a>
        
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>


            <hr class="section-divider">


            <div class="container-fluid mt-3">
                <h3>Top Genres</h3>
                <p>A dive into different popular rock genres and upcoming shows</p>

                <!-- Grunge Section (Image Left) -->
                <div class="container my-5">
                    <div class="row align-items-stretch">
                        <div class="col-md-6 mb-4 mb-md-0 d-flex">
                            <img src="/static/Kurt2.jpg" class="img-fluid section-img" alt="Grunge">
                        </div>
                        <div class="col-md-6 d-flex flex-column">
                            <h2 class="mb-3">Grunge</h2>
                            <p class="mb-4">
                                Grunge music emerged in Seattle during the late 1980s, blending the
                                intensity of punk with the heaviness of metal through distorted guitars
                                and emotionally charged lyrics. Popularized by bands like Nirvana, Pearl
                                Jam, and Soundgarden, it defined 1990s alternative rock with its gritty
                                sound and anti-glamour style.
                            </p>

                            <div class="row row-cols-1 row-cols-md-2 g-4">
                                {% for event in grunge_events %}
                                <div class="col">
                                    <div class="card h-100 genre-card">
                                        <img class="card-img-top event-img"
                                             src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                                             alt="{{ event.title }} image">

                                        <div class="card-body d-flex flex-column p-3">
                                            <h5 class="card-title mb-1">{{ event.title }}</h5>
                                            <p class="card-text small mb-2">
                                                {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }}
                                            </p>
                                            <p class="card-text text-muted mb-3" style="flex-grow: 1;">
                                                {{ event.description[:150] }}{% if event.description|length > 150
                                                %}...{% endif %}
                                            </p>
                                            <p class="card-text small mb-2">
                                                <strong>Status:</strong> {{ event.status.value|capitalize }}
                                            </p>
                                            <a href="{{ url_for('main.details', event_id=event.id) }}"
                                               class="btn btn-dark btn-sm mt-auto w-100">
                                                See Details
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Classic 70s Section (Image Right) -->
                <div class="container my-5">
                    <div class="row align-items-stretch">
                        <div class="col-md-6 order-md-2 mb-4 mb-md-0 d-flex">
                            <img src="/static/LedZep.jpg" class="img-fluid section-img" alt="Classic 70s">
                        </div>
                        <div class="col-md-6 order-md-1 d-flex flex-column">
                            <h2 class="mb-3">Classic 70s</h2>
                            <p class="mb-4">Classic rock of the 1970s grew from 1960s rock, blending blues-inspired
                                riffs,
                                powerful vocals, and extended guitar solos into a bold, stadium-filling sound. Led by
                                bands like
                                Led Zeppelin, The Rolling Stones, and Pink Floyd, it became the soundtrack of a
                                generation,
                                defining the era.</p>
                            <div class="row row-cols-1 row-cols-md-2 g-4">
                                {% for event in seventies_events %}
                                <div class="col">
                                    <div class="card h-100 genre-card">
                                        <img class="card-img-top event-img"
                                             src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                                             alt="{{ event.title }} image">

                                        <div class="card-body d-flex flex-column p-3">
                                            <h5 class="card-title mb-1">{{ event.title }}</h5>
                                            <p class="card-text small mb-2">
                                                {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }}
                                            </p>
                                            <p class="card-text text-muted mb-3" style="flex-grow: 1;">
                                                {{ event.description[:150] }}{% if event.description|length > 150
                                                %}...{% endif %}
                                            </p>
                                            <p class="card-text small mb-2">
                                                <strong>Status:</strong> {{ event.status.value|capitalize }}
                                            </p>
                                            <a href="{{ url_for('main.details', event_id=event.id) }}"
                                               class="btn btn-dark btn-sm mt-auto w-100">
                                                See Details
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Southern Rock Section (Image Left) -->
            <div class="container my-5">
                <div class="row align-items-stretch">
                    <div class="col-md-6 mb-4 mb-md-0 d-flex">
                        <img src="/static/Skynrd.jpg" class="img-fluid section-img" alt="Southern Rock">
                    </div>
                    <div class="col-md-6 d-flex flex-column">
                        <h2 class="mb-3">Southern Rock</h2>
                        <p class="mb-4">Southern rock emerged in the 1970s, blending rock, country, and blues with
                            gritty
                            guitar riffs and soulful vocals. Led by bands like Lynyrd Skynyrd, The Allman Brothers
                            Band, and
                            ZZ Top, it captured the spirit of the American South, combining storytelling with
                            high-energy
                            performances and a distinct regional style.</p>
                        <div class="row row-cols-1 row-cols-md-2 g-4">
                            {% for event in southern_rock_events %}
                            <div class="col">
                                <div class="card h-100 genre-card">
                                    <img class="card-img-top event-img"
                                         src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                                         alt="{{ event.title }} image">

                                    <div class="card-body d-flex flex-column p-3">
                                        <h5 class="card-title mb-1">{{ event.title }}</h5>
                                        <p class="card-text small mb-2">
                                            {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }}
                                        </p>
                                        <p class="card-text text-muted mb-3" style="flex-grow: 1;">
                                            {{ event.description[:150] }}{% if event.description|length > 150 %}...{%
                                            endif %}
                                        </p>
                                        <p class="card-text small mb-2">
                                            <strong>Status:</strong> {{ event.status.value|capitalize }}
                                        </p>
                                        <a href="{{ url_for('main.details', event_id=event.id) }}"
                                           class="btn btn-dark btn-sm mt-auto w-100">
                                            See Details
                                        </a>
                                    </div>
                                </div>
                            </div>

                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Metal Section (Image Right) -->
            <div class="container my-5">
                <div class="row align-items-stretch">
                    <div class="col-md-6 order-md-2 mb-4 mb-md-0 d-flex">
                        <img src="/static/Behemoth.jpg" class="img-fluid section-img" alt="Metal">
                    </div>
                    <div class="col-md-6 order-md-1 d-flex flex-column">
                        <h2 class="mb-3">Metal</h2>
                        <p class="mb-4">Metal music emerged in the late 1960s and 1970s, building on hard rock with
                            heavier
                            riffs, aggressive rhythms, and powerful vocals. Pioneered by bands like Black Sabbath,
                            Iron
                            Maiden, and Judas Priest, it became known for its intense sound, dark themes, and
                            theatrical
                            performances, influencing countless subgenres and shaping the face of heavy music.</p>
                        <div class="row row-cols-1 row-cols-md-2 g-4">
                            {% for event in metal_events %}
                            <div class="col">
                                <div class="card h-100 genre-card">
                                    <img class="card-img-top event-img"
                                         src="{{ url_for('static', filename='uploads/' ~ event.photo) if event.photo else url_for('static', filename='default.jpg') }}"
                                         alt="{{ event.title }} image">

                                    <div class="card-body d-flex flex-column p-3">
                                        <h5 class="card-title mb-1">{{ event.title }}</h5>
                                        <p class="card-text small mb-2">
                                            {{ event.event_date.strftime('%b %d, %Y') }} · {{ event.venue }}
                                        </p>
                                        <p class="card-text text-muted mb-3" style="flex-grow: 1;">
                                            {{ event.description[:150] }}{% if event.description|length > 150 %}...{%
                                            endif %}
                                        </p>
                                        <p class="card-text small mb-2">
                                            <strong>Status:</strong> {{ event.status.value|capitalize }}
                                        </p>
                                        <a href="{{ url_for('main.details', event_id=event.id) }}"
                                           class="btn btn-dark btn-sm mt-auto w-100">
                                            See Details
                                        </a>
                                    </div>
                                </div>
                            </div>

                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
</div>
{% endblock %}
